#!/bin/bash
command=${1?no command given}
shift
set -e

function generate_mailboxes() {

	account=${1?no account given}
	merged=$HOME/.mail/merged

	cd $HOME/.mail/$account

	mailcheckrc=$HOME/.mailcheckrc/$account
	muttrc=$HOME/.mutt/$account"_mailboxes"
	rm -f $mailcheckrc
	rm -f $muttrc
	while read mb
	do
		echo "$HOME/.mail/$account/$mb" >> $mailcheckrc
		name="$mb"_$account
		echo "mailboxes +$name" >> $muttrc

	done < $HOME/.mailboxesrc/$account
}


case $command in
	generate)
		generate_mailboxes "$@"
		;;
	*)
		echo "invalid command: $command"
		exit 1
esac
